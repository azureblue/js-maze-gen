<html>
    <head>
        <title>maze gen</title>
        <script src="utils.js"></script>
        <script src="bytearray.js"></script>
        <script src="color.js"></script>
        <script src="mazegen.js"></script>
        <script src="renderer.js"></script>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="shortcut icon" href="">
        <style>
            label {font-family: monospace; white-space: nowrap; display: block; text-align: right;}
            input {margin-left: auto; width: 50px; font-family: monospace; font-size: medium;}
            input[type=button] {width: auto;}
            p {margin: 5px;}
        </style>
    </head>
    <body>
        <div style="float: left; margin: 5px;">
                <label>width: <input id="iw" type="number" value="10"></label>
                <label>height: <input id="ih" type="number" value="10"></label>
                <label>wall color: <input id="iwc" type="color" value="#789bcb"></label>
                <label>passage color: <input id="ipc" type="color" value="#c9d7f8"></label>
                <label>path color: <input id="isc" type="color" value="#cee5fe"></label>
                <label>wall width: <input id="iws" type="number" value="3"></label>
                <label>passage width: <input id="ips" type="number" value="20"></label>
                    <label>method: <select id="im">
                            <option value="DFSGenerator">Depth-First Search</option>
                            <option value="MSTGenerator">MST</option>
                            <option value="RSGenerator">Recur. Subdivision</option>
                    </select> </label>
                <label>remove walls: <input id="irw" type="number" value="0"></label>
                <input type="button" value="Generate" onclick="generate()"> 
                <input type="button" value="Solve" onclick="solve()"> 
        </div>
        <canvas id="can" style="position: absolute;"></canvas>
        
        <script>
            var ma;
            let getII = (id) => Number.parseInt(document.getElementById(id).value);
            let getIS = (id) => document.getElementById(id).value;      
            let getICol = (id) => Color.fromStyle(document.getElementById(id).value);
            
            function resizeCanvas(w, h) {
                let can = document.getElementById("can");
                can.width = w;
                can.height = h;
                can.style.width = w;
                can.style.height = h;
            }
            
            function generate() {
                var gen = new window[getIS("im")]();
                var maze = gen.generate(getII("iw"), getII("ih"));
                var wl = new WallRemover();
                wl.removeWalls(maze, getII("irw"));
                ma = maze;
                draw();
            }
            
            function draw() {
                let renderer = new SimpleRenderer(getICol("iwc"), getICol("ipc"), getICol("isc"), getII("iws"), getII("ips"));
                let bounds = renderer.getBounds(ma);
                resizeCanvas(bounds.w, bounds.h);
                renderer.render(
                        document.getElementById("can").getContext("2d"), ma);
            }
            
            function solve() {
                var solver = new Solver(new Pos(0, 0), new Pos(getII("iw") - 1, getII("ih") - 1));
                solver.solve(ma);
                draw();
            }

        </script>
    </body>
</html>
